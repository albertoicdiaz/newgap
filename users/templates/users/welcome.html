<!--{% load staticfiles %}-->
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-U A-Compatible" content="IE=edge">
    <title>GAP ANALYSIS | Dashboard</title>
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/font-awesome.css' %}" rel="stylesheet">
    <!-- Toastr style -->
    <link href="{% static 'css/plugins/toastr/toastr.min.css' %}" rel="stylesheet">
    <!-- Gritter -->
    <link href="{% static 'css/plugins/gritter/jquery.gritter.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
</head>
<body>
<div id="wrapper">
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element">
                        <img alt="image" class="rounded-circle" src="{% static 'img/profile_small.jpg' %}"/>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="block m-t-xs font-bold">{{request.user.first_name}}</span>
                            <span class="text-muted text-xs block">Opciones <b class="caret"></b></span>
                        </a>
                        <ul class="dropdown-menu animated fadeInRight m-t-xs">
                            <li class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/logout">Cerrar sesión</a></li>
                        </ul>
                    </div>
                    <div class="logo-element">
                        GAP
                    </div>
                </li>
                <li class="active">
                    <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">Módulos</span> <span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level">
                        <li class="active"><a href="">Responder Encuesta</a></li>
                        <li class="active"><a href="#">Resultados</a></li>
                        </ul>
                </li>
            </ul>
        </div>
    </nav>

    <div id="page-wrapper" class="gray-bg dashbard-1">
        <div class="row  border-bottom white-bg dashboard-header">
            <div class="navbar-header">
                <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
                <form role="search" class="navbar-form-custom" action="search_results.html">
                    <div class="form-group">
                        <!--<input type="text" placeholder="Search for something..." class="form-control" name="top-search" id="top-search">-->
                    </div>
                </form>
            </div>
            <!-- <div class="col-md-12">
                <div class="inbox float-e-margins">
                    <div class="inbox-title">
                        <div class="selector-colegio" >
                            <form>
                                <div class="row  border-bottom white-bg dashboard-header">
                                    <div class="col-md-3">
                                        <label  class="font-normal">Colegio</label>
                                        <select id="school-filter-selector" name="school" class="form-control m-b">
                                            {% if schools|length == 0 or schools|length >= 1 %}
                                            <option value ="0" >Seleccione Colegio</option >
                                            {% endif %}
                                            {% if schools %}
                                            {% for school in schools %}
                                            <option value ={{school.id}}>{{ school.name }}</option >
                                            {% endfor %}
                                            {% endif %}
                                        </select>
                                    </div>

                                    <div  class="col-md-3">
                                        <label class="font-normal">Curso</label>
                                        <select onchange="this.form.submit()" id="course-filter-selector" name="course" class="form-control m-b">
                                            {% if courses|length == 0 or courses|length >= 1 %}
                                            <option value ="0" >Seleccione Curso</option>
                                            {% endif %}
                                            {% if courses %}
                                            {% for course in courses %}
                                            <option value ={{course.id}}>{{course.name}}</option>
                                            {% endfor %}
                                            {% endif %}
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label  class="font-normal">Reim</label>
                                        <select onchange="this.form.submit()" id="reim-filter-selector" name="reim" class="form-control m-b">

                                            {% if reims|length == 0 or reims|length >= 1 %}
                                            <option value="0">Seleccione Reim</option>
                                            {% endif %}
                                            {% if reims %}
                                            {% for reim in reims %}
                                            <option value={{reim.id}}>{{ reim.name }}</option>
                                            {% endfor %}
                                            {% endif %}
                                        </select>
                                    </div>
                                    <div  class="col-md-3">
                                        <label  class="font-normal">Actividad</label>
                                        <select id="activity-filter-selector" name="activity" class="form-control m-b">
                                            <option value ="0">Seleccione Actividad</option>
                                            {% if activities %}
                                            {% for activity in activities %}
                                            <option value ={{activity.id}}>{{activity.name}}</option>
                                            {% endfor %}
                                            {% endif %}
                                        </select>
                                    </div>
                                    <div  class="col-md-8">
                                        <div  class="ibox float-e-margins">
                                            <div  class="form-group" id="data_5">
                                                <label  class="font-normal">Rango de fecha</label>
                                                <div  class="input-daterange input-group" id="datepicker">
                                                    <span class="input-group-addon">Desde</span>
                                                    <span  class="input-group-addon"><i class="fa fa-calendar"></i></span><input onchange="this.form.submit()" style="width:120" type="text" class="input-sm form-control" name="start" id="start-filter-selector" data-provide="datepicker" data-date-format="dd/mm/yyyy" value="dd/mm/aaaa"/>
                                                    <span class="input-group-addon">Hasta</span>
                                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span><input onchange="this.form.submit()" style="width:120px" type="text" class="input-sm form-control" name="end" id="end-filter-selector" data-provide="datepicker" data-date-format="dd/mm/yyyy" value="dd/mm/aaaa"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div  class="col-md-4">
                                        <label  class="font-normal">Alumno</label>
                                        <select id="student-filter-selector" name="student" class="form-control m-b">
                                            <option value ="0">Seleccione Alumno</option>
                                            {% if students %}
                                            {% for student in students %}
                                            <option value ={{student.id}}>{{student.name}}</option>
                                            {% endfor %}
                                            {% endif %}
                                        </select>
                                    </div>
                                    <p class="col-lg-12">
                                        <button class="btn btn-sm btn-primary m-t-n-xs float-right"><i class="fa fa-filter"></i> Filtrar</button>
                                        <a href="/" class="btn btn-sm btn-secondary m-t-n-xs float-right" style="margin-right: 5px"><i class="fa fa-trash"></i> Limpiar</a>
                                    </p>
                                </div>
                            </form>
                        </div>
                    </div>
                </div> -->
            <!-- </div> -->
        </div>

        <div class="wrapper wrapper-content">
            <div class="row">
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°1: Política Seguridad</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 1 %}" class="btn btn-primary">Realizar preguntas</a>
                            
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°2: Organización de la Seguridad Informática</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 2 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°3: Administración Activos</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 3 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°4: Seguridad Recursos Humanos</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 4 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
              </div>
              <div class="row" style="margin-top:30px;">
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°5: Seguridad Física y Ambiental</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 5 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°6: Administración Comunicaciones y Operaciones</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 6 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°7: Control de Accesos</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 7 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Dominio N°8: Adquisición, desarrollo y mantenimiento de Sistemas Informáticos</h5>
                            <p class="card-text">With supporting text below as a natural lead-in to additional content.</p>
                            <a href="{% url 'dominio' 8 %}" class="btn btn-primary">Realizar preguntas</a>
                        </div>
                    </div>
                </div>
              </div>
        </div>

            <!-- Clean Ocean -->
            {% if reim_num == '3' %}
            <div class="wrapper wrapper-content">
                    {% if activity_num == '0' and student_num == '0' %}
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                                    <div class="col-lg-6">
                                        <div class="ibox">
                                            <div class="ibox-title">
                                                <h5>Correctas de actividad destreza y actividad suma</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la comparación de resultados entre dos habilidades: habilidades motrices y habilidades matemáticas."></span>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="analitics" height={{analytics_co_quantity_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="ibox ">
                                            <div class="ibox-title">
                                                <h5>Cantidad de interacciones totales del curso por actividad</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la cantidad de interacciones realizadas por curso en las actividades del REIM 'Clean Ocean'."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="actividadesco" height={{actividades_co_quantity_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                                    <div class="col-lg-6">
                                        <div class="ibox ">
                                            <div class="ibox-title">
                                                <h5>Minutos de juego</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra el tiempo de juego por alumno en el REIM 'Clean Ocean'."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="stacked" height={{game_time_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="ibox">
                                            <div class="ibox-title">
                                                <h5>Cantidad de interacciones por alumno</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la cantidad de interacción por alumno en todo el REIM 'Clean Ocean'."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="horizontalBar" height={{touch_quantity_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                            <!-- <button class="btn btn-sm btn-primary m-t-n-xs float-right" id="download-pdf2" >
                                                Download Higher Quality PDF
                                            </button> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                            <div class="col-lg-12">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="ibox ">
                                            <div class="ibox-title">
                                                <h5>Sesiones por alumno</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la cantidad de inicios de sesión por alumno en el REIM 'Clean Ocean'."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="stacked2" height={{sesion_quantity_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                <!-- Pantalla progreso  -->
                    {% if activity_num == '3000' and student_num == '0' %}
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                                    <div class="col-lg-6">
                                        <div class="ibox ">
                                            <div class="ibox-title">
                                                <h5>Botones tocados por curso en pantalla progreso</h5><span class="glyphicon glyphicon-info-sign" title="Grafico que muestra los botones tocados por todo el curso en la pantalla de progreso."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="touchbuttonsco" height={{buttons_co_quantity_graph}}>{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="ibox ">
                                            <div class="ibox-title">
                                                <h5>Total de basura tocada por curso en pantalla progreso</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra el total de basura tocada por curso en la pantalla progreso."></span>
                                                <div class="ibox-tools"></div>
                                            </div>
                                            <div class="ibox-content">
                                                <div class="scroll_content">
                                                    <canvas id="touchalltrashco" height={{touch_all_trash_quantity_graph}} >{% load staticfiles %}</canvas>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>            
                        </div>
                    {% endif %}
            {% endif %}
            {% if student_num != '0' and reim_num == '3' %}
            <div class="row">
                <div class="col-lg-12">
                    <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                        <div class="col-lg-6">
                            <div class="ibox ">
                                <div class="ibox-title">
                                    <h5>Salidas escogidas en actividad laberinto</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra las salidas escogidas en el laberinto por el alumno seleccionado."></span>
                                    <div class="ibox-tools"></div>
                                </div>
                                <div class="ibox-content">
                                    <div class="scroll_content">
                                        <canvas id="labExitCO" height={{exit_lab_quantity_graph}}>{% load staticfiles %}</canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="ibox ">
                                <div class="ibox-title">
                                    <h5>Correctas e incorrectas por actividad</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la cantidad de veces que el alumno seleccionado concluyó de manera correcta e incorrecta las diversas actividades."></span>
                                    <div class="ibox-tools"></div>
                                </div>
                                <div class="ibox-content">
                                    <div class="scroll_content">
                                        <canvas id="correctsactall" height={{corrects_student_co_quantity_graph}}></canvas>{% load staticfiles %}</canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="row" {% if not activate_graphics %}style="display: none;"{% endif %}>
                        <div class="col-lg-6">
                            <div class="ibox ">
                                <div class="ibox-title">
                                    <h5>Total de basura tocada</h5><span class="glyphicon glyphicon-info-sign" title="Gráfico que muestra la basura tocada por el alumno seleccionado a lo largo de todo el juego."></span>
                                    <div class="ibox-tools"></div>
                                </div>
                                <div class="ibox-content">
                                    <div class="scroll_content">
                                        <canvas id="touchtrash" height={{touch_trash_co_quantity_graph}}>{% load staticfiles %}</canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
                <div>
                    <strong>Copyright</strong>  &copy; 2020


                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-link btn-sm" data-toggle="modal" data-target="#queriesModal">
                        queries
                    </button>

                    <!-- Modal -->
                    <div class="modal fade" id="queriesModal" tabindex="-1" role="dialog" aria-labelledby="queriesModalTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="queriesModalTitle">Generated queries</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <ul>
                                        {% for query in queries %}
                                        <li><strong>{{query.name}}</strong>: {{query.query}}</li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Mainly scripts -->
    <script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script src="{% static 'js/plugins/metisMenu/jquery.metisMenu.js' %}"></script>
    <script src="{% static 'js/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
    <!-- Flot -->
    <script src="{% static 'js/plugins/flot/jquery.flot.js' %}"></script>
    <script src="{% static 'js/plugins/flot/jquery.flot.tooltip.min.js' %}"></script>
    <script src="{% static 'js/plugins/flot/jquery.flot.spline.js' %}"></script>
    <script src="{% static 'js/plugins/flot/jquery.flot.resize.js' %}"></script>
    <script src="{% static 'js/plugins/flot/jquery.flot.pie.js' %}"></script>
    <!-- Peity -->
    <script src="{% static 'js/plugins/peity/jquery.peity.min.js' %}"></script>
    <script src="{% static 'js/demo/peity-demo.js' %}"></script>
    <!-- Custom and plugin javascript -->
    <script src="{% static 'js/inspinia.js' %}"></script>
    <script src="{% static 'js/plugins/pace/pace.min.js' %}"></script>
    <!-- jQuery UI -->
    <script src="{% static 'js/plugins/jquery-ui/jquery-ui.min.js' %}"></script>
    <!-- GITTER -->
    <script src="{% static 'js/plugins/gritter/jquery.gritter.min.js' %}"></script>
    <!-- Sparkline -->
    <script src="{% static 'js/plugins/sparkline/jquery.sparkline.min.js' %}"></script>
    <!-- Sparkline demo data  -->
    <script src="{% static 'js/demo/sparkline-demo.js' %}"></script>
    <!-- ChartJS-->
    <script src="{% static 'js/plugins/chartJs/Chart.min.js' %}"></script>
    <!-- Toastr -->
    <script src="{% static 'js/plugins/toastr/toastr.min.js' %}"></script>
    <!-- Date range picker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>

    <script>
        $('.datepicker').datepicker({
        });
    </script>

    <script>

        var originalLineDraw = Chart.controllers.horizontalBar.prototype.draw;
        Chart.helpers.extend(Chart.controllers.horizontalBar.prototype, {
  
        draw: function () {
          originalLineDraw.apply(this, arguments);
  
          var chart = this.chart;
          var ctx = chart.chart.ctx;
  
          var index = chart.config.options.lineAtIndex;
          if (index) {
  
              var xaxis = chart.scales['x-axis-0'];
              var yaxis = chart.scales['y-axis-0'];
  
              var x1 = xaxis.getPixelForValue(index);                       
              var y1 = yaxis.top;                                                   
  
              var x2 = xaxis.getPixelForValue(index);                       
              var y2 = yaxis.bottom;                                        
  
              ctx.save();
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.strokeStyle = 'green';
              ctx.lineTo(x2, y2);
              ctx.stroke();
  
              ctx.restore();
            
          }
          var index = chart.config.options.lineAtIndex1;
          if (index) {
  
              var xaxis = chart.scales['x-axis-0'];
              var yaxis = chart.scales['y-axis-0'];
  
              var x1 = xaxis.getPixelForValue(index);                       
              var y1 = yaxis.top;                                                   
  
              var x2 = xaxis.getPixelForValue(index);                       
              var y2 = yaxis.bottom;                                        
  
              ctx.save();
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.strokeStyle = 'red';
              ctx.lineTo(x2, y2);
              ctx.stroke();
  
              ctx.restore();
            
          }
          var index3 = chart.config.options.promedioSaltos;
          if (index3) {
  
              var xaxis = chart.scales['x-axis-0'];
              var yaxis = chart.scales['y-axis-0'];
  
              var x1 = xaxis.getPixelForValue(index3);                       
              var y1 = yaxis.top;                                                   
  
              var x2 = xaxis.getPixelForValue(index3);                       
              var y2 = yaxis.bottom;                                        
  
              ctx.save();
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.strokeStyle = 'rgb(207,52,118)';
              ctx.lineTo(x2, y2);
              ctx.stroke();
  
              ctx.restore();
            
          }

          var index4 = chart.config.options.promedioCorrectasCO;
          if (index4) {
  
              var xaxis = chart.scales['x-axis-0'];
              var yaxis = chart.scales['y-axis-0'];
  
              var x1 = xaxis.getPixelForValue(index4);                       
              var y1 = yaxis.top;                                                   
  
              var x2 = xaxis.getPixelForValue(index4);                       
              var y2 = yaxis.bottom;                                        
  
              ctx.save();
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.strokeStyle = 'rgb(87,35,100)';
              ctx.lineTo(x2, y2);
              ctx.stroke();
  
              ctx.restore();
            
          }
          var index5 = chart.config.options.promedioIncorrectasCO;
          if (index5) {
  
              var xaxis = chart.scales['x-axis-0'];
              var yaxis = chart.scales['y-axis-0'];
  
              var x1 = xaxis.getPixelForValue(index5);                       
              var y1 = yaxis.top;                                                   
  
              var x2 = xaxis.getPixelForValue(index5);                       
              var y2 = yaxis.bottom;                                        
  
              ctx.save();
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.strokeStyle = 'rgb(0,255,255)';
              ctx.lineTo(x2, y2);
              ctx.stroke();
  
              ctx.restore();
            
          }
          
      }
  });
        //TIEMPO DE JUEGO GENERAL
        var stackedData = {
            labels:
                    [
                        {% if game_time %}
        {% for user in game_time %}
        '{{user.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Minutos de juego total",
                backgroundColor: 'rgb(46,204,113)',
                borderColor: "rgb(39,174,96)",
                pointBorderColor: "#fff",
                data: [
                    {% if game_time %}
            {% for user in game_time %}
        '{{user.time}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        var stackedOptions = {
            animation: false,
            isFixedWidth:true,
            barWidth:50,
            scales: {
                xAxes:[{
                    stacked:true,
                    ticks: {
                        min: 0,
                        callback: function(value, index, values) {
                            if (Math.floor(value) === value) {
                                return value;
                            }
                        }
                    }
                }],
                yAxes:[{
                    stacked:true,
                }]

            },
            display: true

        };


        if ($('#stacked').length){
            var ctx = document.getElementById("stacked").getContext("2d");
            new Chart(ctx, {type: 'horizontalBar', data: stackedData, options:stackedOptions});
        }
        //TOUCH GENERAL
        var barData = {
            labels: [
                {% if touch_quantity %}
        {% for touch in touch_quantity %}
        '{{touch.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Cantidad de registros",
                backgroundColor: 'rgb(92,107,192)',
                borderColor: "rgb(63,81,181)",
                pointBorderColor: "#fff",
                data: [
                    {% if touch_quantity %}
            {% for touch in touch_quantity %}
        '{{touch.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        var barOptions = {
            animation: false,
            responsive: true,
            isFixedWidth:true,
            scales: {
                xAxes:[{
                    stacked:false,
                    ticks: {
                        min: 0,
                        callback: function(value, index, values) {
                            if (Math.floor(value) === value) {
                                return value;
                            }
                        }
                    }
                }],
                yAxes:[{
                    stacked:false
                }]
            }
        };


        if ($('#horizontalBar').length){
            var ctx2 = document.getElementById("horizontalBar").getContext("2d");
            new Chart(ctx2, {type: 'horizontalBar', data: barData, options:barOptions});
        }
        //SESIONES TOTAL GENERAL
        var stacked2Data = {
            labels: [
                {% if sesion_quantity %}
        {% for sesion in sesion_quantity %}
        '{{sesion.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Sesiones totales",
                backgroundColor: 'rgb(255,152,0)',
                borderColor: "rgb(251,104,0)",
                pointBorderColor: "#fff",
                data: [
                    {% if sesion_quantity %}
            {% for sesion in sesion_quantity %}
        '{{sesion.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        var stacked2Options = {
            animation: false,
            responsive: true,
            isFixedWidth:true,
            scales: {
                xAxes:[{
                    stacked:true,
                    ticks: {
                        min: 0,
                        callback: function(value, index, values) {
                            if (Math.floor(value) === value) {
                                return value;
                            }
                        }
                    }
                }],
                yAxes:[{
                    stacked2:true,
                }]

            },
            display: true
        };

        var BarstackedOptions ={
                scales: {
                    xAxes:[{
                            stacked:false,
                            ticks: {
                                min: 0,
                                callback: function(value, index, values) {
                                    if (Math.floor(value) === value) {
                                        return value;
                                    }
                                }
                            }
                        }],
                yAxes: [{ stacked: false }]
                }
            };

        if ($('#stacked2').length){
            var ctx3 = document.getElementById("stacked2").getContext("2d");
            new Chart(ctx3, {type: 'horizontalBar', data: stacked2Data, options:stacked2Options});
        }

        //Clean Ocean
        var ctx4data = {
            labels: [
                {% if colision_quantity %}
        {% for colision in colision_quantity %}
        '{{colision.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Colisiones totales",
                backgroundColor: 'rgb(207,52,118)',
                borderColor: "rgb(207,52,118)",
                pointBorderColor: "#fff",
                data: [
                    {% if colision_quantity %}
            {% for colision in colision_quantity %}
        '{{colision.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };
        
        if($('#colisions').length){
            var ctx4 = document.getElementById("colisions").getContext("2d");
            new Chart(ctx4, {type: 'horizontalBar', data: ctx4data, options:barOptions});
        }

        var ctx5data = {
            labels: [
                {% if corrects_quantity %}
        {% for corrects in corrects_quantity %}
        '{{corrects.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Correctas totales",
                backgroundColor: 'rgb(81,209,246)',
                borderColor: "rgb(81,209,246)",
                pointBorderColor: "#fff",
                data: [
                    {% if corrects_quantity %}
            {% for corrects in corrects_quantity %}
        '{{corrects.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        if ($('#corrects').length){
            var ctx5 = document.getElementById("corrects").getContext("2d");
            new Chart(ctx5, {type: 'horizontalBar', data: ctx5data, options:barOptions});
        }

        var ctx6data = {
            labels: [
                {% if jumps_quantity %}
        {% for jumps in jumps_quantity %}
        '{{jumps.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Saltos totales",
                backgroundColor: 'rgb(207,52,118)',
                borderColor: "rgb(207,52,118)",
                pointBorderColor: "#fff",
                data: [
                    {% if jumps_quantity %}
                        {% for jumps in jumps_quantity %}
                            '{{jumps.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
            }
        ]
        };

        var jumpsOptions = {
            promedioSaltos: '{{promedio_saltos}}', 
            animation: false,
            responsive: true,
            isFixedWidth:true,
            scales: {
                xAxes:[{
                    stacked:false,
                    ticks: {
                        min: 0,
                        callback: function(value, index, values) {
                            if (Math.floor(value) === value) {
                                return value;
                            }
                        }
                    }
                }],
                yAxes:[{
                    stacked:false
                }]
            }
        };

        if ($('#jumps').length){
            var ctx6 = document.getElementById("jumps").getContext("2d");
            new Chart(ctx6, {type: 'horizontalBar', data: ctx6data, options:jumpsOptions});
        }

        if ($('#prueba').length){
            var ctx7 = document.getElementById('prueba');
            new Chart(ctx7, {
            type: 'horizontalBar',
            data: {
                labels:
                [
                    {% if corrects_incorrects_quantity %}
                        {% for corrects_incorrects in corrects_incorrects_quantity %}
                            '{{corrects_incorrects.name}}',
                        {% endfor%}
                    {% endif%}
                ],
                datasets:
                [
                    {
                        label: "Correctas totales",
                        backgroundColor: 'rgb(87,35,100)',
                        borderColor: "rgb(87,35,100)",
                        pointBorderColor: "#fff",
                        data:
                        [
                            {% if corrects_incorrects_quantity %}
                                {% for corrects_incorrects in corrects_incorrects_quantity %}
                                    '{{corrects_incorrects.corrects}}',
                                {% endfor%}
                            {% endif%}
                        ]
                    },
                    {
                        label: "Incorrectas totales",
                        backgroundColor: 'rgb(0,255,255)',
                        borderColor: "rgb(0,255,255)",
                        pointBorderColor: "#fff",
                        data:
                        [
                            {% if corrects_incorrects_quantity %}
                                {% for corrects_incorrects in corrects_incorrects_quantity %}
                                    '{{corrects_incorrects.incorrects}}',
                                {% endfor%}
                            {% endif%}
                        ]
                    }
                ]
            },
            options: {
                promedioCorrectasCO: '{{promedio_correctas_co}}',
                promedioIncorrectasCO: '{{promedio_incorrectas_co}}',
                scales: {
                    xAxes:[{
                            stacked:false,
                            ticks: {
                                min: 0,
                                callback: function(value, index, values) {
                                    if (Math.floor(value) === value) {
                                        return value;
                                    }
                                }
                            }
                        }],
                yAxes: [{stacked: false }]
                }
            }
            });
        };

        var ctx8data = {
            labels:
            [
                {% if exit_lab_quantity %}
                    {% for exit_lab in exit_lab_quantity %}
                        '{{exit_lab.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Salidas obtenidas",
                backgroundColor: 'rgb(207,52,118)',
                borderColor: "rgb(207,52,118)",
                pointBorderColor: "#fff",
                data:
                [
                {% if exit_lab_quantity %}
                    {% for exit_lab in exit_lab_quantity %}
                        '{{exit_lab.quantity}}',
                    {% endfor%}
                {% endif%}
                ]
                }
            ]
            };

        if ($('#labExitCO').length){
            var ctx8 = document.getElementById('labExitCO');
            new Chart(ctx8, {type: 'horizontalBar', data: ctx8data, options:barOptions});
        }

        if ($('#analitics').length){
            var ctx9 = document.getElementById('analitics');
            new Chart(ctx9, {
            type: 'horizontalBar',
            data: {
                labels:
                [
                    {% if analytics_co_quantity %}
                        {% for analytics_co in analytics_co_quantity %}
                            '{{analytics_co.name}}',
                        {% endfor%}
                    {% endif%}
                ],
                datasets:
                [
                    {
                        label: "Correctas Actividad Destreza",
                        backgroundColor: '#46b3e6',
                        borderColor: "#46b3e6",
                        pointBorderColor: "#fff",
                        data:
                        [
                            {% if analytics_co_quantity %}
                                {% for analytics_co in analytics_co_quantity %}
                                    '{{analytics_co.correctsact1}}',
                                {% endfor%}
                            {% endif%}
                        ]
                    },
                    {
                        label: "Correctas Actividad Suma",
                        backgroundColor: '#c6cbef',
                        borderColor: "#c6cbef",
                        pointBorderColor: "#fff",
                        data:
                        [
                            {% if analytics_co_quantity %}
                                {% for analytics_co in analytics_co_quantity %}
                                    '{{analytics_co.correctsact2}}',
                                {% endfor%}
                            {% endif%}
                        ]
                    },
                ]
            },
                options: {
                    scales: {
                    xAxes: [{ 
                        stacked: false, 
                        }],
                    yAxes: [{ 
                        stacked: false}],
                    },
                }
                });
        }
    
        var ctx11data = {
            labels:
            [
                {% if touch_trash_co_quantity %}
                    {% for touch_trash_co in touch_trash_co_quantity %}
                        '{{touch_trash_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                    label: "Cantidad de basura tocada",
                    backgroundColor: '#fa63d7',
                    borderColor: "#fa63d7",
                    pointBorderColor: "#fff",
                    data:
                    [
                        {% if touch_trash_co_quantity %}
                            {% for touch_trash_co in touch_trash_co_quantity %}
                                '{{touch_trash_co.quantity}}',
                            {% endfor%}
                        {% endif%}
                    ]
                }
            ]
            };

        if ($('#touchtrash').length){
            var ctx11 = document.getElementById("touchtrash");
            new Chart(ctx11, {type: 'horizontalBar', data: ctx11data, options:barOptions});
        }

    //Fin Clean Ocean

    //Set up the chart data
    if ($('#prueba2').length){
        var ctx29 = document.getElementById('prueba2');
        var myChart = new Chart(ctx29, {
        type: 'horizontalBar',
        data: {
            labels: 
            [
                {% if piezas_quantity %}
                    {% for piezas in piezas_quantity %}
                        '{{piezas.name}}',
                    {% endfor%}
                {% endif%}
                
            ],
            datasets: 
            [
                {
                    label: "Correctas",
                    backgroundColor: 'rgb(17,246,133)',
                    borderColor: "rgb(17,246,133)",
                    pointBorderColor: "#fff",
                    data: 
                    [
                        {% if piezas_quantity %}
                            {% for piezas in piezas_quantity %}
                                '{{piezas.quantity}}',
                            {% endfor%}
                        {% endif%}
                    ]
                },
                {
                    label: "Incorrectas",
                    backgroundColor: 'rgb(255,122,122)',
                    borderColor: "rgb(255,122,122)",
                    pointBorderColor: "#fff",
                    data: 
                    [
                        {% if malas_quantity %}
                            {% for malas in malas_quantity %}
                                '{{malas.quantity}}',
                            {% endfor%}
                        {% endif%}
                    ]
                }
            ]
        },
        options: {
                    //Set the index of the value where you want to draw the line
                    lineAtIndex: '{{promedio_correctas}}',  
                    lineAtIndex1: '{{promedio_incorrectas}}',                                                                      
                    scales: {
                            xAxes:[{
                            stacked:false,
                            ticks: {
                                min: 0,
                                callback: function(value, index, values) {
                                    if (Math.floor(value) === value) {
                                        return value;
                                    }
                                }
                            }
                        }]
                    },
                legend: {
                    display: true
                }
            }
        });
    }



        var ctx30data = {
            labels: [
                {% if actividades_co_quantity %}
        {% for actividades_co in actividades_co_quantity %}
        '{{actividades_co.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Cantidad de registros",
                backgroundColor: '#f8766d',
                borderColor: "#f8766d",
                pointBorderColor: "#fff",
                data: [
                    {% if actividades_co_quantity %}
            {% for actividades_co in actividades_co_quantity %}
        '{{actividades_co.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        if($('#actividadesco').length){
            var ctx30 = document.getElementById("actividadesco").getContext("2d");
            new Chart(ctx30, {type: 'horizontalBar', data: ctx30data, options:  barOptions});
        }
    

        var ctx31data = {
            labels: [
                {% if colision_trash_quantity %}
        {% for colision_trash in colision_trash_quantity %}
        '{{colision_trash.name}}',
        {% endfor%}
        {% endif%}
        ],
        datasets: [
            {
                label: "Cantidad de colisiones",
                backgroundColor: '#c49a00',
                borderColor: "#c49a00",
                pointBorderColor: "#fff",
                data: [
                    {% if colision_trash_quantity %}
            {% for colision_trash in colision_trash_quantity %}
        '{{colision_trash.quantity}}',
        {% endfor%}
        {% endif%}
        ]
        }
        ]
        };

        var trashOptions = {
            animation: false,
            responsive: true,
            isFixedWidth:true,
            scales: {
                xAxes:[{
                    stacked:false,
                    ticks: {
                        min: 0,
                        callback: function(value, index, values) {
                            if (Math.floor(value) === value) {
                                return value;
                            }
                        }
                    }
                }],
                yAxes:[{
                    stacked:false
                }]
            }
        };

        if($('#colisiontrash').length){
            var ctx31 = document.getElementById("colisiontrash").getContext("2d");
            new Chart(ctx31, {type: 'horizontalBar', data: ctx31data, options:  trashOptions});
        }

        var ctx33data = {
            labels:
            [
                {% if exits_lab_co_quantity %}
                    {% for exits_lab_co in exits_lab_co_quantity %}
                        '{{exits_lab_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Cantidad de salidas escogidas",
                backgroundColor: '#53b400',
                borderColor: "#53b400",
                pointBorderColor: "#fff",
                data:
                [
                    {% if exits_lab_co_quantity %}
                        {% for exits_lab_co in exits_lab_co_quantity %}
                            '{{exits_lab_co.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
                }
            ]
            };

        if ($('#exitslabco').length){
            var ctx33 = document.getElementById("exitslabco");
            new Chart(ctx33, {type: 'horizontalBar', data: ctx33data, options:barOptions});
        }

        var ctx34data = {
            labels:
            [
                {% if touch_all_trash_quantity %}
                    {% for touch_all_trash in touch_all_trash_quantity %}
                        '{{touch_all_trash.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Cantidad de basura tocada",
                backgroundColor: '#01bfa5',
                borderColor: "#01bfa5",
                pointBorderColor: "#fff",
                data:
                [
                    {% if touch_all_trash_quantity %}
                        {% for touch_all_trash in touch_all_trash_quantity %}
                            '{{touch_all_trash.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
                }
            ]
            };

        if ($('#touchalltrashco').length){
            var ctx34 = document.getElementById("touchalltrashco");
            new Chart(ctx34, {type: 'horizontalBar', data: ctx34data, options:barOptions});
        }

        var ctx35data = {
            labels:
            [
                {% if buttons_co_quantity %}
                    {% for buttons_co in buttons_co_quantity %}
                        '{{buttons_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Cantidad de botones tocados",
                backgroundColor: '#fe0965',
                borderColor: "#fe0965",
                pointBorderColor: "#fff",
                data:
                [
                    {% if buttons_co_quantity %}
                        {% for buttons_co in buttons_co_quantity %}
                            '{{buttons_co.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
                }
            ]
            };

        if ($('#touchbuttonsco').length){
            var ctx35 = document.getElementById("touchbuttonsco");
            new Chart(ctx35, {type: 'horizontalBar', data: ctx35data, options:barOptions});
        }

        var ctx36data = {
            labels:
            [
                {% if trash_clean_co_quantity %}
                    {% for trash_clean_co in trash_clean_co_quantity %}
                        '{{trash_clean_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Cantidad de bolsas recogidas",
                backgroundColor: '#00b5eb',
                borderColor: "#00b5eb",
                pointBorderColor: "#fff",
                data:
                [
                    {% if trash_clean_co_quantity %}
                        {% for trash_clean_co in trash_clean_co_quantity %}
                            '{{trash_clean_co.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
                }
            ]
            };

        if ($('#trashcleanco').length){
            var ctx36 = document.getElementById("trashcleanco");
            new Chart(ctx36, {type: 'horizontalBar', data: ctx36data, options:barOptions});
        }

        var ctx37data = {
            labels:
            [
                {% if corrects_student_co_quantity %}
                    {% for corrects_student_co in corrects_student_co_quantity %}
                        '{{corrects_student_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Cantidad de correctas por actividad",
                backgroundColor: '#00c0c4',
                borderColor: "#00c0c4",
                pointBorderColor: "#fff",
                data:
                [
                    {% if corrects_student_co_quantity %}
                        {% for corrects_student_co in corrects_student_co_quantity %}
                            '{{corrects_student_co.correct}}',
                        {% endfor%}
                    {% endif%}
                ]
                },
                {
                label: "Cantidad de incorrectas por actividad",
                backgroundColor: '#f8766d',
                borderColor: "#f8766d",
                pointBorderColor: "#fff",
                data:
                [
                    {% if corrects_student_co_quantity %}
                        {% for corrects_student_co in corrects_student_co_quantity %}
                            '{{corrects_student_co.incorrect}}',
                        {% endfor%}
                    {% endif%}
                ]
                },

            ]
            };

        if ($('#correctsactall').length){
            var ctx37 = document.getElementById("correctsactall");
            new Chart(ctx37, {type: 'horizontalBar', data: ctx37data, options:barOptions});
        }

        var ctx38data = {
            labels:
            [
                {% if time_act_co_quantity %}
                    {% for time_act_co in time_act_co_quantity %}
                        '{{time_act_co.name}}',
                    {% endfor%}
                {% endif%}
            ],
            datasets:
            [
                {
                label: "Minutos de juego",
                backgroundColor: '#00c0c4',
                borderColor: "#00c0c4",
                pointBorderColor: "#fff",
                data:
                [
                    {% if time_act_co_quantity %}
                        {% for time_act_co in time_act_co_quantity %}
                            '{{time_act_co.quantity}}',
                        {% endfor%}
                    {% endif%}
                ]
                },
            ]
            };

        if ($('#totaltimeco').length){
            var ctx38 = document.getElementById("totaltimeco");
            new Chart(ctx38, {type: 'horizontalBar', data: ctx38data, options:barOptions});
        }
    </script>

    <script>
        function setFilterSelectors(params){
            let queryString = location.search;
            let urlParams = new URLSearchParams(queryString);
            let param = null;
            for(let i = 0; i < params.length; i++ ) {
                param = urlParams.get(params[i])
                if(param && param != 0){
                    document.getElementById(params[i] + "-filter-selector").value = param
                }
            }
        }
        setFilterSelectors(['dominio'])
    </script>

    <!-- <script type="text/javascript">
            setTimeout(function(){
                location = ''
            },10000)
        </script> -->

    <script>
        $(document).ready(function () {

            // Add slimscroll to element
            $('.scroll_content').slimscroll({
                height: '400px'
            })

        });

    // document.getElementById('download-pdf2').addEventListener("click", downloadPDF2);
    // function downloadPDF2() {
    //     var newCanvas = document.querySelector('#stacked');

    //     //create image from dummy canvas
    //         var newCanvasImg = newCanvas.toDataURL("image/jpeg", 1.0);
        
    //         //creates PDF from img
    //         var doc = new jsPDF('landscape');
    //         doc.setFontSize(20);
    //         doc.text(15, 15, "Super Cool Chart");
    //         doc.addImage(newCanvasImg, 'JPEG', 10, 10, 280, 150 );
    //         doc.save('new-canvas.pdf');
    //     }

    </script>
    <script>
        function calculateBarWidth(datasetCount){
            if(options.isFixedWidth){
                return options.barWidth;
            }else{
                var baseWidth = this.calculateBaseWidth() - ((datasetCount - 1) * options.barDatasetSpacing);
                return (baseWidth / datasetCount);
            }}
    </script>
</body>
</html>